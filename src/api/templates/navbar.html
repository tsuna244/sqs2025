<script>

  var current_token = JSON.parse(window.localStorage.token);

  if (current_token != "undefined" || current_token != "null") {

    const headers = { 'Authorization': current_token["token_type"] + " " + current_token["access_token"] }; // auth header with bearer token
    fetch("/get_user", { 
      method: "POST",
      headers: headers 
    })
        .then(response => response.json())
        .then(data => {
              if (data.hasOwnProperty('user_name')) {
                var html = `<span class="navbar-text mr-2">${data["user_name"]}</span>
                            <button class="btn btn-outline-success" type="button" onclick="logout()">Logout</button>
                            `
                document.getElementById('login_register').innerHTML = html
              }
            }
        );
  }

  function logout() {
    window.localStorage.token = "null"
    window.location.href = "/"
  }
  
</script>

<nav class="navbar navbar-expand-lg navbar-dark bg-dark">

  <div class="container-fluid">
    <a class="navbar-brand" href="#"><img style="width: 25px;" src="{{ url_for('static', path='/icon.png') }}" alt="Home"></a>
    <div class="container-fluid">
      <div class="navbar-nav">
        <a class="nav-link active" aria-current="page" href="#">Search Pokemon</a>
        <a class="nav-link disabled" href="#">Packopening</a>
        <a class="nav-link disabled" href="#">Leaderboard</a>
        <a class="nav-link disabled" aria-disabled="true">My-Deck</a>
      </div>
    </div>

    <div>
      <div id="login_register" class="navbar-nav">
        <button class="btn btn-outline-success mr-2" type="button" onclick="location.href='/login'">Login</button>
        <button class="btn btn-outline-success" type="button" onclick="location.href='/register'">Register</button>
      </div>
    </div>
  </div>

</nav>
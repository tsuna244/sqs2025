{% extends "base.html" %}

{% block scripts %} 

<script>

  function send() {
    var formData = new FormData();
    formData.append("username", document.loginform.username.value);
    formData.append("password", document.loginform.password.value);
  
    fetch('/token', {
          method: 'POST',
          body: formData,
        })
        .then(response => response.json())
        .then(data => { // data is a JSON object
          if (data.hasOwnProperty("access_token")) {
            window.localStorage.token = data;
            console.log(JSON.stringify(data));
          }
          else
            console.log(JSON.stringify(data)); 
        })
        .catch(error => {
          console.error(error);
        });
  }
</script>


{% endblock %}

{% block body %}
<div class="container">
	<div class="row d-flex justify-content-center mt-5">
		<div class="col-12 col-md-8 col-lg-6 col-xl-5">
			<div class="card py-3 px-2">
				
        <div class="division">
					<div class="row">
						<div class="col-3"><div class="line l"></div></div>
						<div class="col-6"><span>Login with username and password</span></div>
						<div class="col-3"><div class="line r"></div></div>
					</div>
				</div>

				<form class="myform" name="loginform">
					<div class="form-group">
    				<input id="username" name="username" type="text" class="form-control" placeholder="Username">
  				</div>
 					<div class="form-group">
    				<input id="password" name="password" type="password" class="form-control" placeholder="Password">
  				</div>
  				<div class="form-group mt-3">
  					<button type="button" class="btn btn-block btn-outline-primary btn-lg" onclick="send()"><small><i class="bi bi-person pr-2"></i>Login</small></button>
  				</div>
				</form>

        <div class="division" id="passwd_message">
          <h3>Password must contain the following:</h3>
          <p id="letter" class="invalid">A <b>lowercase</b> letter</p>
          <p id="capital" class="invalid">A <b>capital (uppercase)</b> letter</p>
          <p id="number" class="invalid">A <b>number</b></p>
          <p id="length" class="invalid">Minimum <b>8 characters</b></p>
        </div>

			</div>
		</div>
	</div>
</div>
{% endblock %}